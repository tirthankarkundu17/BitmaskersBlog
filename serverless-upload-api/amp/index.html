<!DOCTYPE html>
<html ⚡>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <script async custom-element="amp-auto-ads" src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">

    </script>
    <title>Serverless Upload API</title>

    <link rel="icon" href="/favicon.png" type="image/png" />
    <link rel="canonical" href="https://bitmaskers.in/serverless-upload-api/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="The Bitmaskers" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Serverless Upload API" />
    <meta property="og:description" content="Serverless most often refers to applications that don&#x27;t require you to provision or manage any servers. You can focus on your core product and business logic instead of responsibilities like operating system (OS) access control, OS patching, provisioning, right-sizing, scaling, and availability. It&#x27;s a revolution in the current technological trend." />
    <meta property="og:url" content="https://bitmaskers.in/serverless-upload-api/" />
    <meta property="og:image" content="https://images.unsplash.com/photo-1592609931041-40265b692757?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDE3fHxhcHBsaWNhdGlvbnxlbnwwfHx8fDE2NTY0ODgzODY&amp;ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;w&#x3D;2000" />
    <meta property="article:published_time" content="2022-06-29T07:43:35.000Z" />
    <meta property="article:modified_time" content="2022-06-29T08:14:01.000Z" />
    <meta property="article:publisher" content="https://www.facebook.com/bitmaskers" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Serverless Upload API" />
    <meta name="twitter:description" content="Serverless most often refers to applications that don&#x27;t require you to provision or manage any servers. You can focus on your core product and business logic instead of responsibilities like operating system (OS) access control, OS patching, provisioning, right-sizing, scaling, and availability. It&#x27;s a revolution in the current technological trend." />
    <meta name="twitter:url" content="https://bitmaskers.in/serverless-upload-api/" />
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1592609931041-40265b692757?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDE3fHxhcHBsaWNhdGlvbnxlbnwwfHx8fDE2NTY0ODgzODY&amp;ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;w&#x3D;2000" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Tirthankar Kundu" />
    <meta property="og:image:width" content="2000" />
    <meta property="og:image:height" content="1333" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "The Bitmaskers",
        "url": "https://bitmaskers.in/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://bitmaskers.in/content/images/2022/06/Logo.png"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Tirthankar Kundu",
        "url": "https://bitmaskers.in/author/tirthankar/",
        "sameAs": []
    },
    "headline": "Serverless Upload API",
    "url": "https://bitmaskers.in/serverless-upload-api/",
    "datePublished": "2022-06-29T07:43:35.000Z",
    "dateModified": "2022-06-29T08:14:01.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://images.unsplash.com/photo-1592609931041-40265b692757?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxMTc3M3wwfDF8c2VhcmNofDE3fHxhcHBsaWNhdGlvbnxlbnwwfHx8fDE2NTY0ODgzODY&ixlib=rb-1.2.1&q=80&w=2000",
        "width": 2000,
        "height": 1333
    },
    "description": "Serverless most often refers to applications that don&#x27;t require you to provision\nor manage any servers. You can focus on your core product and business logic\ninstead of responsibilities like operating system (OS) access control, OS\npatching, provisioning, right-sizing, scaling, and availability.\n\nIt&#x27;s a revolution in the current technological trend. A detailed post on\nserverless can be found below:\n\nAWS ServerlessLet’s see what does Serverless means!The BitmaskersTirthankar\nKundu [http://localho",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://bitmaskers.in/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.48" />
    <link rel="alternate" type="application/rss+xml" title="The Bitmaskers" href="https://bitmaskers.in/rss/" />

    <style amp-custom>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        html {
            overflow-x: hidden;
            overflow-y: scroll;
            font-size: 62.5%;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        }

        body {
            min-height: 100vh;
            margin: 0;
            padding: 0;
            color: #3a4145;
            font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Open Sans, Helvetica Neue, sans-serif;
            font-size: 1.7rem;
            line-height: 1.55em;
            font-weight: 400;
            font-style: normal;
            background: #fff;
            scroll-behavior: smooth;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        p,
        ul,
        ol,
        li,
        dl,
        dd,
        hr,
        pre,
        form,
        table,
        video,
        figure,
        figcaption,
        blockquote {
            margin: 0;
            padding: 0;
        }

        ul[class],
        ol[class] {
            padding: 0;
            list-style: none;
        }

        img {
            display: block;
            max-width: 100%;
        }

        input,
        button,
        select,
        textarea {
            font: inherit;
            -webkit-appearance: none;
        }

        fieldset {
            margin: 0;
            padding: 0;
            border: 0;
        }

        label {
            display: block;
            font-size: 0.9em;
            font-weight: 700;
        }

        hr {
            position: relative;
            display: block;
            width: 100%;
            height: 1px;
            border: 0;
            border-top: 1px solid currentcolor;
            opacity: 0.1;
        }

        ::selection {
            text-shadow: none;
            background: #cbeafb;
        }

        mark {
            background-color: #fdffb6;
        }

        small {
            font-size: 80%;
        }

        sub,
        sup {
            position: relative;
            font-size: 75%;
            line-height: 0;
            vertical-align: baseline;
        }

        sup {
            top: -0.5em;
        }

        sub {
            bottom: -0.25em;
        }

        ul li+li {
            margin-top: 0.6em;
        }

        a {
            color: #1292EE;
            text-decoration-skip-ink: auto;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            margin: 0;
            font-weight: 700;
            color: #121212;
            line-height: 1.4em;
        }

        h1 {
            font-size: 3.4rem;
            line-height: 1.1em;
        }

        h2 {
            font-size: 2.4rem;
            line-height: 1.2em;
        }

        h3 {
            font-size: 1.8rem;
        }

        h4 {
            font-size: 1.7rem;
        }

        h5 {
            font-size: 1.6rem;
        }

        h6 {
            font-size: 1.6rem;
        }

        amp-img {
            height: 100%;
            width: 100%;
            max-width: 100%;
            max-height: 100%;
        }

        amp-img img {
            object-fit: cover;
        }

        .page-header {
            padding: 50px 5vmin 30px;
            text-align: center;
            font-size: 2rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .page-header a {
            color: #121212;
            font-weight: 700;
            text-decoration: none;
            font-size: 1.6rem;
            letter-spacing: -0.1px;
        }

        .post {
            max-width: 680px;
            margin: 0 auto;
        }

        .post-header {
            margin: 0 5vmin 5vmin;
            text-align: center;
        }

        .post-meta {
            margin: 1rem 0 0 0;
            text-transform: uppercase;
            color: #738a94;
            font-weight: 500;
            font-size: 1.3rem;
        }

        .post-image {
            margin: 0 0 5vmin;
        }

        .post-image img {
            display: block;
            width: 100%;
            height: auto;
        }

        .post-content {
            padding: 0 5vmin;
        }

        .post-content>*+* {
            margin-top: 1.5em;
        }

        .post-content [id]:not(:first-child) {
            margin: 2em 0 0;
        }

        .post-content>[id]+* {
            margin-top: 1rem;
        }

        .post-content [id]+.kg-card,
        .post-content blockquote+.kg-card {
            margin-top: 40px;
        }

        .post-content>ul,
        .post-content>ol,
        .post-content>dl {
            padding-left: 1.9em;
        }

        .post-content hr {
            margin-top: 40px;
        }

        .post .post-content hr+* {
            margin-top: 40px;
        }

        .post-content amp-img {
            background-color: #f8f8f8;
        }

        .post-content blockquote {
            position: relative;
            font-style: italic;
        }

        .post-content blockquote::before {
            content: "";
            position: absolute;
            left: -1.5em;
            top: 0;
            bottom: 0;
            width: 0.3rem;
            background: #000;
        }

        .post-content :not(.kg-card):not([id])+.kg-card {
            margin-top: 40px;
        }

        .post-content .kg-card+ :not(.kg-card) {
            margin-top: 40px;
        }

        .kg-card figcaption {
            padding: 1.5rem 1.5rem 0;
            text-align: center;
            font-weight: 500;
            font-size: 1.3rem;
            line-height: 1.4em;
            opacity: 0.6;
        }

        .kg-card figcaption strong {
            color: rgba(0, 0, 0, 0.8);
        }

        .post-content :not(pre) code {
            vertical-align: middle;
            padding: 0.15em 0.4em 0.15em;
            border: #e1eaef 1px solid;
            font-weight: 400;
            font-size: 0.9em;
            line-height: 1em;
            color: #dc0050;
            background: #f0f6f9;
            border-radius: 0.25em;
        }

        .post-content>pre {
            overflow: scroll;
            padding: 16px 20px;
            color: #fff;
            background: #1F2428;
            border-radius: 5px;
            box-shadow: 0 2px 6px -2px rgba(0, 0, 0, .1), 0 0 1px rgba(0, 0, 0, .4);
        }

        .kg-embed-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        .kg-image-card img {
            margin: auto;
        }

        .kg-gallery-card+.kg-gallery-card {
            margin-top: 0.75em;
        }

        .kg-gallery-container {
            position: relative;
        }

        .kg-gallery-row {
            display: flex;
            flex-direction: row;
            justify-content: center;
        }

        .kg-gallery-image {
            width: 100%;
            height: 100%;
        }

        .kg-gallery-row:not(:first-of-type) {
            margin: 0.75em 0 0 0;
        }

        .kg-gallery-image:not(:first-of-type) {
            margin: 0 0 0 0.75em;
        }

        .kg-bookmark-card,
        .kg-bookmark-publisher {
            position: relative;
        }

        .kg-bookmark-container,
        .kg-bookmark-container:hover {
            display: flex;
            flex-wrap: wrap;
            flex-direction: row-reverse;
            color: currentColor;
            background: rgba(255, 255, 255, 0.6);
            font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Open Sans, Helvetica Neue, sans-serif;
            text-decoration: none;
            border-radius: 5px;
            box-shadow: 0 2px 6px -2px rgba(0, 0, 0, 0.1), 0 0 1px rgba(0, 0, 0, 0.4);
            overflow: hidden;
        }

        .kg-bookmark-content {
            flex-basis: 0;
            flex-grow: 999;
            padding: 20px;
            order: 1;
        }

        .kg-bookmark-title {
            font-weight: 600;
            font-size: 1.5rem;
            line-height: 1.3em;
        }

        .kg-bookmark-description {
            display: -webkit-box;
            max-height: 45px;
            margin: 0.5em 0 0 0;
            font-size: 1.4rem;
            line-height: 1.55em;
            overflow: hidden;
            opacity: 0.8;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .kg-bookmark-metadata {
            margin-top: 20px;
        }

        .kg-bookmark-metadata {
            display: flex;
            align-items: center;
            font-weight: 500;
            font-size: 1.3rem;
            line-height: 1.3em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .kg-bookmark-description {
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-line-clamp: 2;
            overflow: hidden;
        }

        .kg-bookmark-metadata amp-img {
            width: 18px;
            height: 18px;
            max-width: 18px;
            max-height: 18px;
            margin-right: 10px;
        }

        .kg-bookmark-thumbnail {
            display: flex;
            flex-basis: 20rem;
            flex-grow: 1;
            justify-content: flex-end;
        }

        .kg-bookmark-thumbnail amp-img {
            max-height: 200px;
        }

        .kg-bookmark-author {
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }

        .kg-bookmark-publisher::before {
            content: "•";
            margin: 0 .5em;
        }

        .kg-width-full.kg-card-hascaption {
            display: grid;
            grid-template-columns: inherit;
        }

        .post-content table {
            border-collapse: collapse;
            width: 100%;
        }

        .post-content th {
            padding: 0.5em 0.8em;
            text-align: left;
            font-size: .75em;
            text-transform: uppercase;
        }

        .post-content td {
            padding: 0.4em 0.7em;
        }

        .post-content tbody tr:nth-child(2n + 1) {
            background-color: rgba(0, 0, 0, 0.1);
            padding: 1px;
        }

        .post-content tbody tr:nth-child(2n + 2) td:last-child {
            box-shadow:
                inset 1px 0 rgba(0, 0, 0, 0.1),
                inset -1px 0 rgba(0, 0, 0, 0.1);
        }

        .post-content tbody tr:nth-child(2n + 2) td {
            box-shadow: inset 1px 0 rgba(0, 0, 0, 0.1);
        }

        .post-content tbody tr:last-child {
            border-bottom: 1px solid rgba(0, 0, 0, .1);
        }

        .page-footer {
            padding: 60px 5vmin;
            margin: 60px auto 0;
            text-align: center;
            background-color: #f8f8f8;
        }

        .page-footer h3 {
            margin: 0.5rem 0 0 0;
        }

        .page-footer p {
            max-width: 500px;
            margin: 1rem auto 1.5rem;
            font-size: 1.7rem;
            line-height: 1.5em;
            color: rgba(0, 0, 0, 0.6)
        }

        .powered {
            display: inline-flex;
            align-items: center;
            margin: 30px 0 0;
            padding: 6px 9px 6px 6px;
            border: rgba(0, 0, 0, 0.1) 1px solid;
            font-size: 12px;
            line-height: 12px;
            letter-spacing: -0.2px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
            font-weight: 500;
            color: #222;
            text-decoration: none;
            background: #fff;
            border-radius: 6px;
        }

        .powered svg {
            height: 16px;
            width: 16px;
            margin: 0 6px 0 0;
        }

        @media (max-width: 600px) {
            body {
                font-size: 1.6rem;
            }

            h1 {
                font-size: 3rem;
            }

            h2 {
                font-size: 2.2rem;
            }
        }

        @media (max-width: 400px) {
            h1 {
                font-size: 2.6rem;
                line-height: 1.15em;
            }

            h2 {
                font-size: 2rem;
                line-height: 1.2em;
            }

            h3 {
                font-size: 1.7rem;
            }
        }
    </style>

    <style amp-boilerplate>
        body {
            -webkit-animation: -amp-start 8s steps(1, end) 0s 1 normal both;
            -moz-animation: -amp-start 8s steps(1, end) 0s 1 normal both;
            -ms-animation: -amp-start 8s steps(1, end) 0s 1 normal both;
            animation: -amp-start 8s steps(1, end) 0s 1 normal both
        }

        @-webkit-keyframes -amp-start {
            from {
                visibility: hidden
            }

            to {
                visibility: visible
            }
        }

        @-moz-keyframes -amp-start {
            from {
                visibility: hidden
            }

            to {
                visibility: visible
            }
        }

        @-ms-keyframes -amp-start {
            from {
                visibility: hidden
            }

            to {
                visibility: visible
            }
        }

        @-o-keyframes -amp-start {
            from {
                visibility: hidden
            }

            to {
                visibility: visible
            }
        }

        @keyframes -amp-start {
            from {
                visibility: hidden
            }

            to {
                visibility: visible
            }
        }
    </style><noscript>
        <style amp-boilerplate>
            body {
                -webkit-animation: none;
                -moz-animation: none;
                -ms-animation: none;
                animation: none
            }
        </style>
    </noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <amp-auto-ads type="adsense" data-ad-client="ca-pub-7990894864273181">
    </amp-auto-ads>
    <header class="page-header">
        <a href="https://bitmaskers.in">
            <amp-img class="site-icon" src="https://bitmaskers.in/content/images/2022/06/iconfav.png" width="50" height="50"
                layout="fixed"></amp-img>
        </a>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Serverless Upload API</h1>
                <section class="post-meta">
                    Tirthankar Kundu -
                    <time class="post-date" datetime=" 2022-06-29">29 Jun                        2022</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="https://images.unsplash.com/photo-1592609931041-40265b692757?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDE3fHxhcHBsaWNhdGlvbnxlbnwwfHx8fDE2NTY0ODgzODY&amp;ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;w&#x3D;2000" width="600" height="340" layout="responsive">
                </amp-img>
            </figure>
            <section class="post-content">

                <p>Serverless most often refers to applications that don't require you to provision or manage any servers. You can focus on your core product and business logic instead of responsibilities like operating system (OS) access control, OS patching, provisioning, right-sizing, scaling, and availability.</p><p>It's a revolution in the current technological trend. A detailed post on serverless can be found below:</p><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://bitmaskers.in/aws-serverless/"><div class="kg-bookmark-content"><div class="kg-bookmark-title">AWS Serverless</div><div class="kg-bookmark-description">Let’s see what does Serverless means!</div><div class="kg-bookmark-metadata"><span class="kg-bookmark-author">The Bitmaskers</span><span class="kg-bookmark-publisher">Tirthankar Kundu</span></div></div><div class="kg-bookmark-thumbnail"></div></a></figure><p>Today, we will see how to create a serverless upload API using <a href="https://www.serverless.com/">Serverless</a> and AWS Java SDK</p><hr></hr><blockquote>Prerequisites</blockquote><ul><li>Install <a href="https://nodejs.org/en/">NodeJs</a> and <a href="https://www.npmjs.com/">npm</a></li><li>Install <a href="https://www.serverless.com/framework/docs/getting-started">Serverless Framework</a> with AWS account</li><li>Install <a href="https://www.openlogic.com/openjdk-downloads">JDK</a> and export to User or System Path</li><li>Install <a href="https://maven.apache.org/">Apache Maven</a> and export to User or System Path</li></ul><hr></hr><blockquote>Bootstrap serverless project</blockquote><ul><li>The first step is to bootstrap the serverless project <br />Use the below code to generate the bootstrapped codebase</li></ul><pre><code>serverless create --template aws-java-maven --name uploads-api -p uploads-api
</code></pre>
<ul><li>Update the pom file with the correct artifactId and name and package name as per requirement</li><li>Try building the application</li></ul><p>You should see the application build successfully with the command -<br />
<code>mvn clean package</code></p>
<figure class="kg-card kg-image-card"></figure><hr></hr><blockquote>Restructure codebase</blockquote><ul><li>Restructure the app to look something like below</li></ul><figure class="kg-card kg-image-card"></figure><ul><li>Folder details -	<br />	dto - Data Transfer Objects(POJO) goes here<br />	entity - Bean Java POJO goes here<br />	handler - Lambda Handler goes here<br />	service - Service Interface and Implementation goes here<br />	utility - The utility code goes here</li></ul><hr></hr><blockquote>Create the Handler</blockquote><ul><li>We will create a new handler CreatePersignedURLHandler under the handler package</li><li>Handler is the entry point for the Lambda function</li></ul><p></p><blockquote>Create S3 Utility</blockquote><p>Now we will create the most important part of the code which will help us create the Presigned URL</p><ul><li>First, add the required dependency</li></ul><pre><code>&lt;dependency&gt;
    &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;
    &lt;artifactId&gt;aws-java-sdk-s3&lt;/artifactId&gt;
    &lt;version&gt;1.12.249&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<ul><li>Next, we will create a class singleton S3Util</li><li>This will contain a function createPresignedURL which accepts - bucket name, key/name of the file, and time to live for the presigned URL</li></ul><figure class="kg-card kg-image-card"></figure><hr></hr><blockquote>Add Service</blockquote><ul><li>Let's first create an Interface called UploadService which will hold the contract for generating the presigned URL</li></ul><pre><code>public interface UploadService {
    AppResponse processCreatePresignedURL(Map&lt;String, Object&gt; input);
}
</code></pre>
<ul><li>Next, we will implement this Interface for actual functionality<br />For detailed code see -</li></ul><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://github.com/tirthankarkundu17/serverless-uploads-api/blob/main/src/main/java/in/bitmaskers/service/UploadServiceImpl.java"><div class="kg-bookmark-content"><div class="kg-bookmark-title">serverless-uploads-api/UploadServiceImpl.java at main · tirthankarkundu17/serverless-uploads-api</div><div class="kg-bookmark-description">Contribute to tirthankarkundu17/serverless-uploads-api development by creating an account on GitHub.</div><div class="kg-bookmark-metadata"><amp-img class="kg-bookmark-icon" src="https://github.com/fluidicon.png" alt width="512" height="512" layout="responsive"></amp-img><span class="kg-bookmark-author">GitHub</span><span class="kg-bookmark-publisher">tirthankarkundu17</span></div></div><div class="kg-bookmark-thumbnail"><amp-img src="https://opengraph.githubassets.com/35f33815dec647d2878048e718c6c3ed2b846de68372a9a17527e44b0a656bb0/tirthankarkundu17/serverless-uploads-api" alt width="1200" height="600" layout="responsive"></amp-img></div></a></figure><ul><li>Now we will call this service from our handler</li></ul><figure class="kg-card kg-image-card"></figure><ul><li>The response from the service will be responded to calling the client</li></ul><hr></hr><blockquote>Serverless Config</blockquote><p>Finally, we need the serverless.yml config which will create the necessary resources in AWS for our serverless stack</p><p>Our serverless.yml will look like this -</p><pre><code># This name will appear in AWS cloud formation
service: uploads-api

# Serverless Framework Version
frameworkVersion: '3'
custom:
  bucketName: test-upload-bucket123
  region: us-east-2

# General Lambda configuration goes here
provider:
  name: aws
  runtime: java8.al2 # AWS Linux 2 Corretto 8
  stage: dev
  region: ${self:custom.region}
  # IAM Policies for the function goes here
  iam:
    role:
      statements:
        - Effect: "Allow"
          Action:
            - "s3:*"
          Resource: !Sub
            - arn:aws:s3:::${self:custom.bucketName}/*
            - BucketName: !Ref UploadBucket

# Package artifact to use for deployment
package:
  artifact: target/uploads-api-dev.jar

# Lambda function configuration
functions:
  hello:
    # Handler location
    handler: in.bitmaskers.handler.GetPresignedURLHandler
    # Environment variables
    environment:
      BUCKET_NAME: ${self:custom.bucketName}
      REGION: ${self:custom.region}
    # Use AWS Gateway HTTP API as lambda trigger
    events:
      - httpApi:
          path: /create-presigned-url # Path of API
          method: post # Method type

# Cloudformation Resource Template
resources:
  Resources:
    UploadBucket:
      Type: AWS::S3::Bucket
      Properties:
        BucketName: ${self:custom.bucketName}
</code></pre>
<p>The comments added will give details on each node in yml</p><hr></hr><blockquote>Deployment</blockquote><p>Deployment is the easiest part for a serverless app since everything is managed by AWS.</p><p>After configuring everything, we need to package our app and deploy it.</p><ul><li>Package the app </li></ul><pre><code>mvn clean package
</code></pre>
<ul><li>Serverless deploy</li></ul><pre><code>sls deploy
</code></pre>
<p>We will see stack getting created and deployed</p><figure class="kg-card kg-image-card"></figure><hr></hr><blockquote>Let's take it for a spin 🚀</blockquote><ul><li>Pass required param as JSON and do a POST call</li></ul><figure class="kg-card kg-image-card"></figure><ul><li>Use the presigned URL returned to do another PUT operation with the binary file. We will receive a 200 status code, which means the file was uploaded successfully 🎊</li></ul><figure class="kg-card kg-image-card"></figure><ul><li>PUT call on presigned URL after TTL expiry throws error as below</li></ul><figure class="kg-card kg-image-card"></figure><ul><li>We can now see the file created in S3</li></ul><figure class="kg-card kg-image-card"></figure><hr></hr><p>That's all folks! Pretty lengthy blog but hope you liked it.</p><p>Cheer! 🍻</p>

            </section>

        </article>
    </main>
    <footer class="page-footer">
        <amp-img class="site-icon" src="https://bitmaskers.in/content/images/2022/06/iconfav.png" width="50" height="50" layout="fixed">
        </amp-img>
        <h3>The Bitmaskers</h3>
        <p>One stop shelter for Software Development Tools, News and Business!</p>
        <p><a href="https://bitmaskers.in">Read more posts →</a></p>
    </footer>
    
</body>

</html>